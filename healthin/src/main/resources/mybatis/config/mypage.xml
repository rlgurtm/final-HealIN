<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mypage">
 	<insert id="insertUserPhysicalInfo" parameterType="physicalInfoVO">
 		insert into physical_info(physical_no,height,weight,today,user_id)
 		values(physical_no_seq.nextval,#{height},#{weight},sysdate,#{user_Id})
 	</insert>
 	<select id="selectUserPhyicalInfo" resultType="physicalInfoVO" parameterType="map">
 	select * from (
	 		select row_number() over(order by physical_no desc) as rnum
	 		,physical_no,height,weight,to_char(today,'YYYY.MM.DD') as today,user_id as user_Id
	 		,round(weight/(height*height/10000),2) as bmiValue
	 		from physical_info
	 		where user_id=#{user_id} )
 		where rnum between #{pb.startRowNumber} and #{pb.endRowNumber}
 	</select>
 	<select id="graphContentCount" resultType="int" parameterType="string">
 		select count(*) 
 		from physical_info
 		where user_id=#{value}
 		order by physical_no desc
 	</select>
 	<resultMap type="physicalInfoVO" id="physicalMap" />
 	<select id="graphPagingBean" resultMap="physicalMap" parameterType="pagingBean">
 		select b.physical_no,b.height,b.weight,b.today,b.user_id
 		from(select row_number() over(order by physical_no desc) as rnum,
 				physical_no,height,weight,to_char(today,'YYYY-MM-DD') as today,user_id
 				from physical_info
 				)
 				b, physical_info p
 		where b.user_id = p.user_id and rnum between #{startRowNumber} and #{endRowNumber}
 		order by physical_no desc
 	</select>
</mapper>
 
